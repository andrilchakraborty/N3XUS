<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>N3XUS LEAKS</title>

  <!-- Open Graph / Facebook Embed -->
  <meta property="og:title" content="N3XUS LEAKS" />
  <meta property="og:description" content="N3XUS LEAKS Your one-stop aggregator to find leaks for OnlyFans, Erome, JPG5 and more. Browse galleries across multiple leak sites instantly." />
  <meta property="og:image" content="https://media.discordapp.net/attachments/1343576085098664020/1364464992593772644/raw.png?ex=680d104c&is=680bbecc&hm=788bc73c49593be5a6e0495d7a99419dde66ba77f6b66601bcb58d65d60ce267&=&format=webp&quality=lossless&width=882&height=882" />
  <meta property="og:url" content="https://n3xusleaks.up.railway.app/?#" />
  <meta property="og:type" content="website" />

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="N3XUS LEAKS" />
  <meta name="twitter:description" content="Your one-stop tool to find leaks for OnlyFans, Erome, JPG5 and more. Search by creator name and browse cached galleries offline." />
  <meta name="twitter:image" content="https://media.discordapp.net/attachments/1343576085098664020/1364464992593772644/raw.png?ex=680d104c&is=680bbecc&hm=788bc73c49593be5a6e0495d7a99419dde66ba77f6b66601bcb58d65d60ce267&=&format=webp&quality=lossless&width=882&height=882" />

  <!-- Tab Icon -->
  <link id="tab-icon" rel="icon" href="https://media.discordapp.net/attachments/1343576085098664020/1364464992593772644/raw.png?ex=680d104c&is=680bbecc&hm=788bc73c49593be5a6e0495d7a99419dde66ba77f6b66601bcb58d65d60ce267&=&format=webp&quality=lossless&width=882&height=882" />

  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css?family=Montserrat:400,600,700&display=swap" rel="stylesheet"/>

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>

  <!-- JSZip for admin uploads -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js"></script>

  <style>
    :root {
      --bg-dark: #0d0d0f;
      --bg-darker: #131318;
      --text-light: #e1e1e6;
      --text-muted: #7a7a8c;
      --accent: #e6007e;
      --accent-hover: #ff1a95;
      --sidebar-width: 240px;
    }
    * { margin:0; padding:0; box-sizing:border-box; font-family:'Montserrat',sans-serif; }
    body { overflow: hidden; }

    /* Auth Modal overlay */
    #auth-modal {
      display: none;
      position: fixed;
      top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.75);
      align-items: center; justify-content: center;
      z-index: 100000;
    }
    #auth-modal form {
      background: var(--bg-darker);
      padding: 32px;
      border-radius: 8px;
      max-width: 320px;
      width: 100%;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    #auth-modal h2 {
      color: var(--accent);
      font-size: 24px;
      text-align: center;
    }
    #auth-modal input {
      padding: 10px;
      font-size: 14px;
      border: 1px solid var(--text-muted);
      border-radius: 4px;
      background: #1a1a1f;
      color: var(--text-light);
    }
    #auth-modal button {
      padding: 10px;
      font-size: 16px;
      background: var(--accent);
      border: none;
      border-radius: 4px;
      color: #fff;
      cursor: pointer;
      transition: background .2s;
    }
    #auth-modal button:hover {
      background: var(--accent-hover);
    }
    #auth-toggle {
      text-align: center;
      color: var(--text-muted);
      font-size: 14px;
      cursor: pointer;
    }
    #auth-error {
      color: #ff4d4f;
      font-size: 13px;
      min-height: 18px;
      text-align: center;
    }

    /* Preloader overlay */
    #preloader {
      position: fixed; top:0; left:0; width:100%; height:100%;
      background: var(--bg-dark);
      display:flex; flex-direction:column; align-items:center; justify-content:center;
      z-index:99999;
      transition: opacity .5s ease;
    }
    #preloader img {
      width:350px; height:auto;
      box-shadow: 0 0 12px var(--accent-hover);
    }
    #loading-bar {
      width:0; height:6px; background:var(--accent);
      box-shadow: 0 0 8px var(--accent-hover);
      margin-top:20px;
      transition: width 1.5s ease;
    }
    #preloader.fade-out {
      opacity:0;
      pointer-events:none;
    }
    html, .main { overflow: hidden; }
    #preloader.fade-out ~ body, #preloader.fade-out ~ .main {
      overflow: auto;
    }

    body { display:flex; min-height:100vh; background:var(--bg-dark); color:var(--text-light); }
    a { text-decoration:none; color:inherit; }

    /* Global button styles */
    button {
      border:2px solid var(--accent);
      border-radius:6px;
      background:none;
      color:var(--accent);
      cursor:pointer;
      transition: box-shadow .2s, background .2s, color .2s;
    }
    button:hover {
      box-shadow: 0 0 8px var(--accent-hover);
      background:var(--accent);
      color:#fff;
    }

    /* Sidebar */
    .sidebar {
      position:fixed; top:0; left:0;
      width:var(--sidebar-width); height:100%;
      background:var(--bg-darker);
      display:flex; flex-direction:column; padding-top:20px;
    }
    .sidebar ul { list-style:none; padding:0 20px; }
    .sidebar li + li { margin-top:12px; }
    .sidebar li a {
      display:flex; align-items:center;
      padding:12px 16px; border-radius:4px;
      transition: background .2s;
    }
    .sidebar li a:hover, .sidebar li a.active {
      background: rgba(230,0,126,0.1);
    }
    .sidebar i { margin-right:12px; font-size:18px; }

    /* Main panel */
    .main {
      margin-left:var(--sidebar-width);
      flex:1; display:flex; flex-direction:column;
      overflow: auto;
    }

    /* Header */
    .header {
      height:60px; background:var(--bg-darker);
      display:flex; align-items:center;
      justify-content:space-between; padding:0 20px;
    }
    #search-controls { display:flex; align-items:center; }
    #search-form {
      display:flex; align-items:center;
    }
    #search-input, #jpg5-input {
      padding:6px 10px; font-size:14px;
      border:none; border-radius:4px; width:200px;
      background:#1a1a1f; color:var(--text-light);
    }
    #jpg5-input { margin-left:8px; width:250px; }
    #search-btn, #jpg5-btn {
      padding:6px 12px; border-radius:4px;
      background:var(--accent); color:#fff; margin-left:4px;
      border:none;
    }

    /* Telegram & Discord buttons */
    .header-btn {
      display:flex;
      align-items:center; justify-content:center;
      width:44px; height:44px;
      border-radius:6px;
      font-size:22px; margin-left:8px;
      border:none;
      background:var(--bg-darker);
      color:var(--text-light);
      transition: background .2s;
    }
    .header-btn:hover { background:rgba(230,0,126,0.1); }

    /* Intro */
    #intro {
      padding:60px 40px; text-align:center;
      animation: fadeIn 1.5s ease-in;
    }
    #intro h2 {
      font-size:36px; color:var(--accent);
      margin-bottom:16px;
      animation: slideDown 1s ease-out;
    }
    #intro p {
      color:var(--text-muted); line-height:1.5; max-width:600px; margin:0 auto;
    }
    @keyframes fadeIn { from { opacity:0; } to { opacity:1; } }
    @keyframes slideDown { from { transform:translateY(-20px); opacity:0; } to { transform:translateY(0); opacity:1; } }

    /* Home – Community Servers */
    #home-servers {
      padding:20px 40px; animation: fadeIn 1.5s ease-in;
    }
    #home-servers h2 {
      font-size:28px; color:var(--accent); margin-bottom:16px;
    }
    .server-cards {
      display:grid;
      grid-template-columns:repeat(auto-fill, minmax(200px,1fr));
      gap:16px;
    }
    .server-card {
      background:var(--bg-darker);
      border-radius:4px; overflow:hidden;
      display:flex; flex-direction:column;
      transition: transform .2s, box-shadow .3s;
    }
    .server-card:hover {
      transform:scale(1.03);
      box-shadow:0 0 12px var(--accent-hover);
    }
    .server-card img {
      width:100%; height:120px; object-fit:cover;
    }
    .server-card .info {
      padding:12px; flex:1; display:flex; flex-direction:column;
    }
    .server-card .info h3 {
      font-size:16px; margin-bottom:8px; color:var(--text-light);
    }
    .server-card .info p {
      font-size:14px; color:var(--text-muted); flex:1;
    }
    .server-card .info a {
      margin-top:12px; padding:8px 12px;
      background:var(--accent); color:#fff; border:none;
      border-radius:4px; text-decoration:none;
      text-align:center;
    }

    /* Context menu */
    #img-context-menu {
      position: fixed;
      background: rgba(20,0,20,0.95);
      border: 2px solid var(--accent);
      border-radius: 6px;
      box-shadow: 0 0 8px var(--accent-hover);
      color: var(--text-light);
      display: none;
      z-index: 10000;
      padding: 4px 0;
    }
    #img-context-menu div {
      padding: 8px 16px;
      cursor: pointer;
      white-space: nowrap;
      transition: background .2s;
    }
    #img-context-menu div:hover {
      background: rgba(230,0,126,0.1);
    }

    .content { flex:1; overflow-y:auto; padding-top:20px; }

    /* Status Message */
    #status-message {
      display: none;
      text-align: center;
      padding: 10px 20px;
      font-size: 18px;
      color: var(--accent);
      text-shadow: 0 0 8px var(--accent-hover);
      animation: glow 1.5s ease-in-out infinite;
    }
    @keyframes glow {
      0%, 100% { text-shadow: 0 0 5px var(--accent), 0 0 10px var(--accent-hover); }
      50% { text-shadow: 0 0 20px var(--accent-hover), 0 0 30px var(--accent); }
    }

    /* Search Section */
    #search-section { display:none; padding:20px 40px; }
    .search-cards { display:grid; gap:16px; grid-template-columns:repeat(auto-fill,minmax(160px,1fr)); }

    /* Models Section */
    .models-section { padding:20px 40px; display:none; }
    #model-list-tools {
      display:flex; align-items:center; flex-wrap:wrap;
      gap:8px; margin-bottom:16px;
    }
    #model-filter-input {
      padding:6px 10px; font-size:14px; border:none;
      border-radius:4px; width:200px;
      background:#1a1a1f; color:var(--text-light);
    }
    #model-az-list button {
      background:none; border:none; color:var(--accent);
      cursor:pointer; font-size:14px; padding:4px 6px;
      border-radius:4px; transition:background .2s;
    }
    #model-az-list button:hover { background:rgba(230,0,126,0.1); }

    .model-cards { display:grid; gap:16px; grid-template-columns:repeat(auto-fill,minmax(160px,1fr)); }
    .model-card {
      background:var(--bg-darker); border-radius:4px; overflow:hidden;
      cursor:pointer; transition:transform .1s;
      display:flex; flex-direction:column;
    }
    .model-card:hover { transform:scale(1.02); }
    .model-card img {
      width:100%; height:100px; object-fit:cover;
    }
    .model-card .info {
      padding:8px; text-align:center;
    }
    .model-card .info h3 {
      font-size:14px; margin-bottom:4px; color:var(--text-light);
    }
    .model-card .info p {
      font-size:12px; color:var(--text-muted);
    }

    /* Dual-thumbnail support */
    .model-card.dual-thumb .thumb-container {
      display: flex;
    }
    .model-card.dual-thumb .thumb-container .thumb-half {
      width: 50%;
      height: 100px;
      object-fit: cover;
    }
    .model-card .delete-btn {
      display: none;
      position: absolute;
      top: 8px;
      right: 8px;
      background: rgba(230,0,126,0.8);
      border: none;
      border-radius: 4px;
      color: #fff;
      padding: 4px 6px;
      font-size: 12px;
      cursor: pointer;
    }
    .admin-mode .model-card .delete-btn {
      display: block;
    }

    /* Gallery subview */
    #gallery-view { display:none; padding:20px 40px; overflow:auto; }
    #back-btn {
      background:none; border:none; color:var(--accent);
      cursor:pointer; margin-bottom:16px; font-size:14px;
    }
    .endpoint-section { margin-bottom:24px; }
    .endpoint-section h3 { font-size:18px; margin-bottom:8px; color:var(--accent); display:inline-block; }
    .items-grid {
      display:grid; gap:16px;
      grid-template-columns:repeat(auto-fill,minmax(120px,1fr));
    }
    .item-wrapper { position:relative; }
    .items-grid img {
      width:100%; height:auto; border-radius:4px; display:block;
    }
    .item-btn {
      position:absolute; top:4px; background:rgba(0,0,0,0.6);
      color:#fff; border:none; border-radius:50%; width:24px; height:24px;
      cursor:pointer; display:flex; align-items:center; justify-content:center;
    }
    .edit-btn { right:32px; }
    .delete-btn { right:4px; }

    /* JPG5 Section (same as models) */
    #jpg5-section { display:none; padding:20px 40px; }
    #jpg5-section h2 { color:var(--accent); margin-bottom:16px; }

    /* FAQ Accordion */
    .accordion { max-width:800px; margin:40px auto; }
    .accordion-item {
      background:var(--bg-darker); border-radius:4px;
      margin-bottom:16px; overflow:hidden;
    }
    .accordion-item button {
      width:100%; background:none; border:none;
      color:var(--text-light); text-align:left;
      padding:20px; font-size:16px;
      display:flex; justify-content:space-between;
      align-items:center; cursor:pointer;
      transition: background .2s;
    }
    .accordion-item button:hover { background:rgba(255,255,255,0.05); }
    .accordion-item button i {
      font-size:20px; transition:transform .3s;
    }
    .panel {
      max-height:0; overflow:hidden;
      transition:max-height .3s ease;
      background:var(--bg-dark);
    }
    .panel p { padding:0 20px 20px; color:var(--text-muted); }

    /* Terms */
    #terms {
      max-width:800px; margin:40px auto;
      color:var(--text-muted); line-height:1.5; padding:0 20px;
    }

    /* Footer */
    .footer {
      background:var(--bg-darker);
      padding:40px 20px; color:var(--text-muted);
      display:flex; justify-content:space-between; flex-wrap:wrap;
    }
    .footer .left { max-width:600px; }
    .footer .left h3 { color:#fff; margin-bottom:8px; }
    .footer .links { list-style:none; display:flex; flex-wrap:wrap; margin-top:16px; }
    .footer .links li { margin-right:16px; margin-bottom:8px; }

    /* Back to top */
    .back-to-top {
      position:fixed; bottom:20px; right:50%;
      transform:translateX(50%);
      background:var(--accent); width:48px; height:48px;
      border-radius:50%; display:flex; align-items:center;
      justify-content:center; color:#fff; cursor:pointer;
      transition:background .2s;
    }
    .back-to-top:hover { background:var(--accent-hover); }

    /* Admin panel */
    #admin-panel {
      display:none;
      position:fixed; top:60px; right:20px;
      background:var(--bg-darker);
      padding:20px;
      border:2px solid var(--accent);
      border-radius:6px;
      z-index:1000;
      width:260px;
    }
    #admin-panel h3 { margin-bottom:12px; color:var(--accent); }
    #admin-panel input { width:100%; padding:6px 10px; margin-bottom:8px; border:none; border-radius:4px; background:#1a1a1f; color:var(--text-light); }
  </style>
</head>
<body>
  <!-- Auth Modal -->
  <div id="auth-modal">
    <form id="auth-form">
      <h2 id="auth-title">Login</h2>
      <input id="auth-username" placeholder="Username" required/>
      <input id="auth-password" type="password" placeholder="Password" required/>
      <button type="submit" id="auth-submit">Login</button>
      <div id="auth-toggle">No account? Register</div>
      <div id="auth-error"></div>
    </form>
  </div>

  <!-- Preloader -->
  <div id="preloader">
    <img src="https://media.discordapp.net/attachments/1343576085098664020/1364464992593772644/raw.png?ex=680d104c&is=680bbecc&hm=788bc73c49593be5a6e0495d7a99419dde66ba77f6b66601bcb58d65d60ce267&=&format=webp&quality=lossless&width=882&height=882" alt="Loading"/>
    <div id="loading-bar"></div>
  </div>

  <!-- Sidebar -->
  <aside class="sidebar">
    <ul>
      <li><a href="#" id="menu-home" class="active"><i class="fas fa-star"></i> Home</a></li>
      <li><a href="#" id="menu-search"><i class="fas fa-search"></i> Search</a></li>
      <li><a href="#" id="menu-models"><i class="fas fa-user"></i> Models</a></li>
      <li><a href="#" id="menu-jpg5"><i class="fas fa-images"></i> JPG5 Albums</a></li>
      <li><a href="#" id="menu-faq"><i class="fas fa-question-circle"></i> FAQ</a></li>
      <li><a href="#" id="menu-terms"><i class="fas fa-file-alt"></i> Terms</a></li>
    </ul>
  </aside>

  <!-- Main panel -->
  <div class="main">
    <header class="header">
      <h1 style="color:var(--accent);">N3XUS LEAKS</h1>
      <div id="search-controls">
        <form id="search-form">
          <input id="search-input" placeholder="Search term…" autocomplete="off"/>
          <button type="submit" id="search-btn"><i class="fas fa-search"></i></button>
        </form>
        <input id="jpg5-input" placeholder="JPG5 album URL…" autocomplete="off"/>
        <button id="jpg5-btn">Fetch JPG5</button>
      </div>
      <button id="telegram-btn" class="header-btn"><i class="fab fa-telegram-plane"></i></button>
      <button id="discord-btn" class="header-btn"><i class="fab fa-discord"></i></button>
    </header>

    <div class="content">
      <div id="status-message"></div>

      <!-- Intro -->
      <section id="intro">
        <h2>Welcome to N3XUS LEAKS</h2>
        <p>
          Search any creator name and instantly pull galleries across multiple leak-sites.
          The results are saved locally so you can browse even if the internet goes down.
          Simply enter a search term above and view thumbnails; click a card to open all links.
        </p>
      </section>

      <!-- Home – Community Servers -->
      <section id="home-servers">
        <h2>Join Our Community Servers</h2>
        <div class="server-cards" id="servers-grid"></div>
      </section>

      <!-- Search Results -->
      <section id="search-section">
        <h2>Search Results</h2>
        <div class="search-cards" id="search-grid"></div>
      </section>

      <!-- Models -->
      <section class="models-section" id="models-section">
        <div id="model-list-tools">
          <input id="model-filter-input" type="text" placeholder="Filter models…"/>
          <div id="model-az-list"></div>
        </div>
        <div class="model-cards" id="models-grid"></div>
      </section>

      <!-- JPG5 Albums -->
      <section id="jpg5-section">
        <h2>JPG5 Albums</h2>
        <div class="model-cards" id="jpg5-grid"></div>
      </section>

      <!-- Gallery View -->
      <section id="gallery-view">
        <button id="back-btn"><i class="fas fa-arrow-left"></i> Back</button>
        <h2 id="model-title"></h2>
        <div id="album-links"></div>
      </section>

      <!-- FAQ -->
      <section id="faq" class="accordion">
        <div class="accordion-item">
          <button>What does this site do? <i class="fas fa-plus"></i></button>
          <div class="panel"><p>Aggregates publicly-available galleries from multiple sources.</p></div>
        </div>
        <div class="accordion-item">
          <button>How does offline work? <i class="fas fa-plus"></i></button>
          <div class="panel"><p>Results are saved in your browser’s LocalStorage so you can revisit them without reloading.</p></div>
        </div>
        <div class="accordion-item">
          <button>Is this legal? <i class="fas fa-plus"></i></button>
          <div class="panel"><p>We simply link to public content. We do not host any copyrighted materials.</p></div>
        </div>
      </section>

      <!-- Terms -->
      <section id="terms">
        <h2>Terms &amp; Conditions</h2>
        <p>By using this site you agree not to redistribute copyrighted content. N3XUS LEAKS is not responsible for external site availability.</p>
      </section>
    </div>

    <!-- Footer -->
    <footer class="footer">
      <div class="left">
        <h3>N3XUS LEAKS</h3>
        <p>Your one-stop aggregator for leak galleries across the web. No subscriptions, no logins—just search and browse.</p>
        <ul class="links">
          <li><a href="#" id="faq-link">FAQ</a></li>
          <li><a href="#" id="terms-link">Terms</a></li>
          <li><a href="#">Privacy</a></li>
          <li><a href="#">Contact</a></li>
        </ul>
      </div>
    </footer>
  </div>

  <!-- Back to top -->
  <div class="back-to-top"><i class="fas fa-arrow-up"></i></div>

  <!-- Context menu -->
  <div id="img-context-menu">
    <div data-action="copy-image">Copy Image</div>
    <div data-action="copy-url">Copy Image URL</div>
    <div data-action="open">Open Image in New Tab</div>
  </div>

  <!-- Admin Panel -->
  <div id="admin-panel">
    <h3>Admin Panel</h3>
    <input id="new-server-title" placeholder="Server Title" />
    <input id="new-server-desc" placeholder="Description" />
    <input id="new-server-url" placeholder="Invite URL" />
    <input id="new-server-icon" placeholder="Thumbnail URL" />
    <button id="add-server-btn">Add Server Card</button>
    <hr style="border-color:var(--accent);margin:12px 0;">
    <input id="new-model-name" type="text" placeholder="Model Name" />
    <input id="new-model-zip" type="file" accept=".zip" />
    <button id="upload-btn">Upload Model</button>
    <input id="tab-icon-url" type="text" placeholder="Tab Icon URL" />
    <button id="tab-icon-btn">Set Tab Icon</button>
    <hr style="border-color:var(--accent);margin:12px 0;">
    <!-- Delete a model by name (in case it isn’t visible in the JSON list) -->
    <input id="delete-model-name" type="text" placeholder="Model Name to Delete" />
    <button id="delete-model-btn">Delete Model</button>
  </div>

  <script>
    const DEFAULT_THUMB = 'https://media.discordapp.net/attachments/1343576085098664020/1364464992593772644/raw.png?ex=680d104c&is=680bbecc&hm=788bc73c49593be5a6e0495d7a99419dde66ba77f6b66601bcb58d65d60ce267&=&format=webp&quality=lossless&width=882&height=882';

    // API helper
    async function API(path, opts={}) {
      const token = localStorage.getItem('n3xus_token');
      opts.headers = opts.headers||{};
      if (token) opts.headers['Authorization'] = 'Bearer '+token;
      return fetch(path, opts);
    }

    // Auth modal logic
    const authModal   = document.getElementById('auth-modal'),
          authForm    = document.getElementById('auth-form'),
          authTitle   = document.getElementById('auth-title'),
          authToggle  = document.getElementById('auth-toggle'),
          authSubmit  = document.getElementById('auth-submit'),
          authError   = document.getElementById('auth-error');
    let isLogin = true;

    authToggle.onclick = () => {
      isLogin = !isLogin;
      authTitle.textContent   = isLogin ? 'Login' : 'Register';
      authSubmit.textContent  = isLogin ? 'Login' : 'Register';
      authToggle.textContent  = isLogin ? 'No account? Register' : 'Have an account? Login';
      authError.textContent   = '';
    };

    authForm.onsubmit = async e => {
      e.preventDefault();
      authError.textContent = '';
      const u = document.getElementById('auth-username').value.trim();
      const p = document.getElementById('auth-password').value;
      const url = isLogin ? '/api/login' : '/api/register';
      const opts = isLogin
        ? {
            method:'POST',
            headers:{'Content-Type':'application/x-www-form-urlencoded'},
            body:`username=${encodeURIComponent(u)}&password=${encodeURIComponent(p)}`
          }
        : {
            method:'POST',
            headers:{'Content-Type':'application/json'},
            body:JSON.stringify({username:u,password:p})
          };
      const res = await fetch(url, opts);
      if (!res.ok) {
        authError.textContent = await res.text();
        return;
      }
      if (isLogin) {
        const { access_token } = await res.json();
        localStorage.setItem('n3xus_token', access_token);
        authModal.style.display = 'none';
        initApp();
      } else {
        // after successful registration, switch to login
        authToggle.click();
      }
    };

    // On load
    window.addEventListener('DOMContentLoaded', async ()=>{
      const token = localStorage.getItem('n3xus_token');
      if (!token) {
        authModal.style.display = 'flex';
      } else {
        authModal.style.display = 'none';
        initApp();
      }
    });
    // All endpoints…
    const endpoints = [
      { name:'Erome Gallery',   url:q=>`/api/erome-gallery?query=${q}`,       type:'gallery' },
      { name:'Erome Albums',    url:q=>`/api/erome-albums?username=${q}`,     type:'albums'  },
      { name:'Bunkr Gallery',   url:q=>`/api/bunkr-gallery?query=${q}`,       type:'gallery' },
      { name:'Bunkr Albums',    url:q=>`/api/bunkr-albums?query=${q}`,        type:'albums'  },
      { name:'NotFans',         url:q=>`/api/notfans?search_term=${q}`,       type:'urls',   key:['urls','titles'] },
      { name:'Influencers',     url:q=>`/api/influencers?term=${q}`,          type:'urls',   key:['urls','titles'] },
      { name:'Thothub',         url:q=>`/api/thothub?term=${q}`,              type:'urls',   key:['urls','titles'] },
      { name:'DirtyShip',       url:q=>`/api/dirtyship?term=${q}`,            type:'urls',   key:['urls','titles'] },
      { name:'PimpBunny',       url:q=>`/api/pimpbunny?term=${q}`,            type:'urls',   key:['urls','titles'] },
      { name:'LeakedZone',      url:q=>`/api/leakedzone?term=${q}`,           type:'urls',   key:['urls','titles'] },
      { name:'FanslyLeaked',    url:q=>`/api/fanslyleaked?term=${q}`,         type:'urls',   key:['urls','titles'] },
      { name:'GotAnyNudes',     url:q=>`/api/gotanynudes?term=${q}`,          type:'urls',   key:['urls','titles'] },
      { name:'NSFW247',         url:q=>`/api/nsfw247?term=${q}`,             type:'urls',   key:['urls','titles'] },
      { name:'HornySimp',       url:q=>`/api/hornysimp?term=${q}`,           type:'urls',   key:['urls','titles'] },
      { name:'Porntn',          url:q=>`/api/porntn?term=${q}`,              type:'urls',   key:['urls','titles'] },
      { name:'xxBrits',         url:q=>`/api/xxbrits?term=${q}`,             type:'urls',   key:['urls','titles'] },
      { name:'BitchesGirls',    url:q=>`/api/bitchesgirls?term=${q}`,        type:'urls',   key:['urls','titles'] },
      { name:'ThotsLife',       url:q=>`/api/thotslife?term=${q}`,           type:'urls',   key:['urls','titles'] },
      { name:'Fapello Gallery', url:q=>`/api/fapello-gallery?album_url=${q}`,type:'gallery' },
      { name:'JPG5 Gallery',    url:q=>`/api/jpg5-gallery?album_url=${q}`,    type:'gallery' }
    ];
    // DOM refs
    const serversGrid = document.getElementById('servers-grid'),
          searchForm  = document.getElementById('search-form'),
          searchIn    = document.getElementById('search-input'),
          searchGrid  = document.getElementById('search-grid'),
          modelsGrid  = document.getElementById('models-grid'),
          jpg5Grid    = document.getElementById('jpg5-grid'),
          menuHome    = document.getElementById('menu-home'),
          menuSearch  = document.getElementById('menu-search'),
          menuModels  = document.getElementById('menu-models'),
          menuJPG5    = document.getElementById('menu-jpg5'),
          menuFaq     = document.getElementById('menu-faq'),
          menuTerms   = document.getElementById('menu-terms'),
          intro       = document.getElementById('intro'),
          searchSec   = document.getElementById('search-section'),
          modelsSec   = document.getElementById('models-section'),
          jpg5Sec     = document.getElementById('jpg5-section'),
          galleryView = document.getElementById('gallery-view'),
          faqSec      = document.getElementById('faq'),
          termsSec    = document.getElementById('terms'),
          backBtn     = document.getElementById('back-btn'),
          modelTitle  = document.getElementById('model-title'),
          albumLinks  = document.getElementById('album-links'),
          faqBtns     = document.querySelectorAll('.accordion-item button'),
          backToTop   = document.querySelector('.back-to-top'),
          telegramBtn = document.getElementById('telegram-btn'),
          discordBtn  = document.getElementById('discord-btn'),
          azList      = document.getElementById('model-az-list'),
          filterIn    = document.getElementById('model-filter-input'),
          jpg5Input   = document.getElementById('jpg5-input'),
          jpg5Btn     = document.getElementById('jpg5-btn'),
          uploadBtn   = document.getElementById('upload-btn'),
          adminPanel  = document.getElementById('admin-panel'),
          tabIconLink = document.getElementById('tab-icon'),
          tabIconInput= document.getElementById('tab-icon-url'),
          tabIconBtn  = document.getElementById('tab-icon-btn');

    // State
    let servers = [], results = [];

    async function initApp(){
      // hide auth modal just in case
      authModal.style.display = 'none';

      // Preloader
      const bar = document.getElementById('loading-bar'),
            pre = document.getElementById('preloader');
      setTimeout(()=>bar.style.width='100%',100);
      setTimeout(()=>pre.classList.add('fade-out'),1600);
      setTimeout(()=>{
        pre.remove();
        document.documentElement.style.overflow='auto';
        document.body.style.overflow='auto';
        document.querySelector('.main').style.overflow='auto';
      },2200);

      // Fetch servers
      try {
        const res = await API('/api/servers');
        if (res.ok) servers = await res.json();
      } catch {}
      if (!servers.length) {
        servers = [
          { name:'Exiled NSFW', description:'Join our Discord community only if you’re not a snowflake.', url:'https://discord.gg/exiled', icon:'https://media.discordapp.net/attachments/1274042631755796481/1365442988871913493/a_c5ed72320e7c8bd846e511c8ce6cbcc4.gif?ex=680d5361&is=680c01e1&hm=0feeb7770d0f4a6c35b10e9aefac2df99a961fbe5e59ce901950da7c29824fef&='},
          { name:'Sinners', description:'NSFW Discord server.', url:'https://discord.gg/sinners', icon:'https://media.discordapp.net/attachments/1343576085098664020/1364832623326924821/Sinners.jpg?ex=680d152e&is=680bc3ae&hm=87f7490788ce7163c74033b3550e19158097fa3a94cb88e5a23947fb0d9beea6&=&format=webp' },
          { name:'Goon Gave', description:'NSFW server find any leaks of ur fav model.', url:'https://discord.gg/y6EdJBAvF9', icon:'https://media.discordapp.net/attachments/1341633831773667368/1363999969907834970/raw.png?ex=680cb0b6&is=680b5f36&hm=c25a0bf169776a6eec15ba148cd9461df0208ca7c242da059eb86b93137d1efe&=&format=webp&quality=lossless&width=350&height=350' },
          { name:'Crows', description:'Chill chat.', url:'https://discord.gg/drQkVnZRYe', icon:'https://media.discordapp.net/attachments/1051449361327980574/1365446118376476732/Crows_e-girls_Nitro__Social__Giveaways__Voicechat-1.gif?ex=680d564b&is=680c04cb&hm=95446b0bf898eef13b967dd1e3d1a758b56a57c9b0f8f06d1a3730475d91cd0c&=' }
        ];
      }
      renderServers();

      // Fetch models
      try {
        const res = await API('/api/models');
        if (res.ok) results = await res.json();
      } catch {}
      if (!results.length) {
        results = JSON.parse(localStorage.getItem('n3xus_results')||'[]');
      }
      renderModels(results);
      renderJPG5(results);

      // Common init
      initNav();
      initFAQ();
      initModelsTools();
      initBackToTop();
      loadTabIcon();
      showSection('home');

      telegramBtn.addEventListener('click',()=>window.open('https://t.me/murdaleaksss','_blank'));
      discordBtn.addEventListener('click',()=>window.open('https://discord.gg/exiled','_blank'));
      jpg5Btn.addEventListener('click',fetchJPG5Album);
      tabIconBtn.addEventListener('click',setTabIcon);
      uploadBtn.addEventListener('click',()=>document.getElementById('new-model-zip').click());
    }

    /*─── renderServers ───────────────────────────────────────────────────────────*/
    function renderServers(){
      serversGrid.innerHTML = '';
      servers.forEach(s => {
        const card = document.createElement('div');
        card.className = 'server-card';
        card.innerHTML = `
          <img src="${s.icon}" alt="${s.name}" />
          <div class="info">
            <h3>${s.name}</h3>
            <p>${s.description}</p>
            <a href="${s.url}" target="_blank">Join</a>
          </div>`;
        serversGrid.appendChild(card);
      });
    }

    /*─── Tab Icon ────────────────────────────────────────────────────────────────*/
    function loadTabIcon(){
      const url = localStorage.getItem('n3xus_tab_icon');
      if (url) { tabIconLink.href = url; tabIconInput.value = url; }
    }
    function setTabIcon(){
      const url = tabIconInput.value.trim();
      if (!url) return alert('Enter a valid URL.');
      tabIconLink.href = url;
      localStorage.setItem('n3xus_tab_icon', url);
      alert('Tab icon updated!');
    }

    /*─── Navigation & Search ────────────────────────────────────────────────────*/
    function initNav(){
      [menuHome,menuSearch,menuModels,menuJPG5,menuFaq,menuTerms].forEach(btn=>{
        btn.addEventListener('click',e=>{
          e.preventDefault();
          showSection(btn.id.replace('menu-',''));
        });
      });
      searchForm.addEventListener('submit',async e=>{
        e.preventDefault();
        let q = searchIn.value.trim(); if (!q) return;
        showStatus(`Fetching leaks for ${q}…`);
        let ok = await doSearch(q);
        if (!ok) { showStatus(`No leaks found for ${q}`); return; }
        renderSearch([results[results.length-1]]);
        renderModels(results);
        showSection('search');
        clearStatus();
      });
    }
    async function doSearch(term){
      let model={name:term,endpoints:[]};
      for(let ep of endpoints){
        if(ep.name==='JPG5 Gallery') continue;
        try{
          let res=await API(ep.url(encodeURIComponent(term)));
          if(!res.ok) throw '';
          let data=await res.json(), items=[];
          if(ep.type==='gallery') items=data.images||[];
          else if(ep.type==='albums') items=data.albums||[];
          else{
            let urls=data[ep.key[0]]||[], titles=data[ep.key[1]]||[];
            items=urls.map((u,i)=>({url:u,title:titles[i]||u}));
          }
          if(items.length) model.endpoints.push({...ep,items});
        }catch{}
      }
      if(term.startsWith('http')){
        try{
          let res=await API(`/api/jpg5-gallery?album_url=${encodeURIComponent(term)}`);
          if(res.ok){
            let d=await res.json();
            if(d.images?.length) model.endpoints.push({name:'JPG5 Gallery',type:'gallery',items:d.images});
          }
        }catch{}
      }
      if(!model.endpoints.length) return false;
      results.push(model);
      localStorage.setItem('n3xus_results',JSON.stringify(results));
      await API('/api/models',{
        method:'POST',
        headers:{'Content-Type':'application/json'},
        body:JSON.stringify(model)
      });
      return true;
    }
    function showStatus(msg){
      const s = document.getElementById('status-message');
      s.textContent = msg; s.style.display = 'block';
    }
    function clearStatus(){
      document.getElementById('status-message').style.display = 'none';
    }

    /*─── renderSearch ──────────────────────────────────────────────────────────*/
    function renderSearch(list){
      searchGrid.innerHTML='';
      list.forEach(m=>{
        const erome = m.endpoints.find(e=>e.name==='Erome Gallery');
        const bunkr = m.endpoints.find(e=>e.name==='Bunkr Gallery');
        let thumbHtml='';
        if(erome){
          let u = erome.items[0].url||erome.items[0];
          thumbHtml+=`<img src="${u}" class="thumb-half" />`;
        }
        if(bunkr){
          let u=bunkr.items[0].url||bunkr.items[0];
          thumbHtml+=`<img src="${u}" class="thumb-half" />`;
        }
        if(!thumbHtml){
          thumbHtml=`<img src="${DEFAULT_THUMB}" />`;
        }
        const card=document.createElement('div');
        card.className = thumbHtml.includes('thumb-half') ?
          'model-card dual-thumb' : 'model-card';
        card.innerHTML = `
          <div class="thumb-container">${thumbHtml}</div>
          <div class="info"><h3>${m.name}</h3><p>${m.endpoints.length} sources</p></div>`;
        card.addEventListener('click',()=>openGallery(m));
        searchGrid.appendChild(card);
      });
    }

    /*─── renderModels ──────────────────────────────────────────────────────────*/
    function renderModels(list){
      modelsGrid.innerHTML='';
      list.forEach(m=>{
        const erome = m.endpoints.find(e=>e.name==='Erome Gallery');
        const bunkr = m.endpoints.find(e=>e.name==='Bunkr Gallery');
        let thumbHtml = '';
        if (erome){
          let u = erome.items[0].url||erome.items[0];
          thumbHtml += `<img src="${u}" class="thumb-half" />`;
        }
        if (bunkr){
          let u = bunkr.items[0].url||bunkr.items[0];
          thumbHtml += `<img src="${u}" class="thumb-half" />`;
        }
        if (!thumbHtml) thumbHtml = `<img src="${DEFAULT_THUMB}" />`;
        const card = document.createElement('div');
        card.className = thumbHtml.includes('thumb-half') ? 'model-card dual-thumb' : 'model-card';
        card.innerHTML = `
          <button class="delete-btn" data-name="${m.name}">Delete</button>
          <div class="thumb-container">${thumbHtml}</div>
          <div class="info"><h3>${m.name}</h3><p>${m.endpoints.length} sources</p></div>`;
        // click on card opens gallery (unless clicking delete)
        card.addEventListener('click', e => {
          if (e.target.closest('.delete-btn')) return;
          openGallery(m);
        });
        // delete-button handler
        card.querySelector('.delete-btn').addEventListener('click', async e => {
          e.stopPropagation();
          const name = e.currentTarget.dataset.name;
          if (!confirm(`Delete model “${name}”?`)) return;
          const res = await API(`/api/models/${encodeURIComponent(name)}`, { method:'DELETE' });
          if (res.status === 204){
            results = results.filter(x => x.name !== name);
            localStorage.setItem('n3xus_results', JSON.stringify(results));
            renderModels(results);
            renderJPG5(results);
          } else {
            const text = await res.text();
            alert(`Failed to delete ${name}: ${text}`);
          }
        });
        modelsGrid.appendChild(card);
      });
    }

    /*─── renderJPG5 ───────────────────────────────────────────────────────────*/
    function renderJPG5(list){
      jpg5Grid.innerHTML='';
      list.filter(m=>m.endpoints.some(e=>e.name==='JPG5 Gallery')).forEach(m=>{
        let ep=m.endpoints.find(e=>e.name==='JPG5 Gallery');
        let thumb=ep.items[0]||DEFAULT_THUMB;
        let card=document.createElement('div'); card.className='model-card';
        card.innerHTML=`<img src="${thumb}" /><div class="info"><h3>${m.name}</h3><p>${ep.items.length} images</p></div>`;
        card.addEventListener('click',()=>openGallery(m));
        jpg5Grid.appendChild(card);
      });
    }

    /*─── openGallery ───────────────────────────────────────────────────────────*/
    function openGallery(model){
      [intro,document.getElementById('home-servers'),searchSec,modelsSec,jpg5Sec,faqSec,termsSec].forEach(el=>el.style.display='none');
      galleryView.style.display='block';
      modelTitle.textContent=model.name;
      albumLinks.innerHTML='';
      const ordered=model.endpoints
        .filter(e=>e.name!=='Erome Gallery'&&e.name!=='Bunkr Gallery')
        .concat(model.endpoints.filter(e=>e.name==='Erome Gallery'))
        .concat(model.endpoints.filter(e=>e.name==='Bunkr Gallery'));

      ordered.forEach(ep=>{
        let sec=document.createElement('div'); sec.className='endpoint-section';
        let hdr=document.createElement('div');
        hdr.innerHTML=`<h3>${ep.name} (${ep.items.length})</h3>`;
        sec.appendChild(hdr);
        let grid=document.createElement('div'); grid.className='items-grid';
        ep.items.forEach((item,idx)=>{
          let url=item.url||item;
          let thumb=ep.type==='gallery'?url:(ep.thumbnail||DEFAULT_THUMB);
          let wrap=document.createElement('div'); wrap.className='item-wrapper';
          let a=document.createElement('a'); a.href=url; a.target='_blank';
          let img=document.createElement('img'); img.src=thumb;
          a.appendChild(img); wrap.appendChild(a);
          grid.appendChild(wrap);
        });
        sec.appendChild(grid);
        albumLinks.appendChild(sec);
      });
    }
    backBtn.addEventListener('click',()=>showSection('search'));

    /*─── showSection ────────────────────────────────────────────────────────────*/
    function showSection(sec){
      [intro,document.getElementById('home-servers'),searchSec,modelsSec,jpg5Sec,galleryView,faqSec,termsSec].forEach(el=>el.style.display='none');
      document.querySelectorAll('.sidebar a').forEach(a=>a.classList.remove('active'));
      if(sec==='home'){
        intro.style.display='block';
        document.getElementById('home-servers').style.display='block';
        menuHome.classList.add('active');
      } else if(sec==='search'){
        searchSec.style.display='block'; menuSearch.classList.add('active');
      } else if(sec==='models'){
        modelsSec.style.display='block'; menuModels.classList.add('active');
      } else if(sec==='jpg5'){
        jpg5Sec.style.display='block'; menuJPG5.classList.add('active');
      } else if(sec==='faq'){
        faqSec.style.display='block'; menuFaq.classList.add('active');
      } else if(sec==='terms'){
        termsSec.style.display='block'; menuTerms.classList.add('active');
      }
    }

    /*─── FAQ Accordion ─────────────────────────────────────────────────────────*/
    function initFAQ(){
      faqBtns.forEach(btn=>{
        btn.addEventListener('click',()=>{
          const panel=btn.nextElementSibling, icon=btn.querySelector('i');
          if(panel.style.maxHeight){
            panel.style.maxHeight=null; icon.classList.replace('fa-minus','fa-plus');
          } else {
            panel.style.maxHeight=panel.scrollHeight+'px'; icon.classList.replace('fa-plus','fa-minus');
          }
        });
      });
    }

    /*─── Models A–Z & Filter ───────────────────────────────────────────────────*/
    function initModelsTools(){
      'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('').forEach(letter=>{
        const btn=document.createElement('button'); btn.textContent=letter;
        btn.addEventListener('click',()=>filterModels(letter));
        azList.appendChild(btn);
      });
      filterIn.addEventListener('input',()=>filterModels(filterIn.value.trim()));
    }
    function filterModels(f){
      Array.from(modelsGrid.children).forEach(card=>{
        const name=card.querySelector('h3').textContent.toLowerCase();
        card.style.display = (!f||(f.length===1?name.startsWith(f.toLowerCase()):name.includes(f.toLowerCase()))) ? 'block' : 'none';
      });
    }

    /*─── Back to Top ───────────────────────────────────────────────────────────*/
    function initBackToTop(){
      window.addEventListener('scroll',()=>{
        backToTop.style.display=(window.scrollY>200?'flex':'none');
      });
      backToTop.addEventListener('click',()=>window.scrollTo({top:0,behavior:'smooth'}));
    }

    /*─── Fetch JPG5 Album ──────────────────────────────────────────────────────*/
    async function fetchJPG5Album(){
      const url=jpg5Input.value.trim();
      if(!url) return alert('Enter a JPG5 album URL.');
      showStatus('Fetching images from JPG5 album…');
      try{
        const res=await API(`/api/jpg5-gallery?album_url=${encodeURIComponent(url)}`);
        if(!res.ok) throw '';
        const data=await res.json();
        if(!data.images.length){
          showStatus(`No leaks found for ${url}`); return;
        }
        const model={ name:url, endpoints:[{name:'JPG5 Gallery',type:'gallery',items:data.images}] };
        results.push(model);
        localStorage.setItem('n3xus_results',JSON.stringify(results));
        await API('/api/models',{
          method:'POST', headers:{'Content-Type':'application/json'},
          body:JSON.stringify(model)
        });
        renderModels(results); renderJPG5(results);
        showSection('jpg5'); clearStatus();
      }catch{
        alert('Error fetching JPG5 album.');
      }
    }

    // Admin activation (Ctrl+I)
    document.addEventListener('keydown',e=>{
      if(e.ctrlKey&&e.key.toLowerCase()==='i'){
        let pwd=prompt('Enter admin password:');
        if(pwd==='cassidy'){ adminPanel.style.display='block'; alert('Admin mode enabled.'); }
        else alert('Incorrect password.');
      }
    });

    // Add Server
    document.getElementById('add-server-btn').onclick = async ()=>{
      const newSrv = {
        name: document.getElementById('new-server-title').value.trim(),
        description: document.getElementById('new-server-desc').value.trim(),
        url: document.getElementById('new-server-url').value.trim(),
        icon: document.getElementById('new-server-icon').value.trim()
      };
      if(!newSrv.name||!newSrv.url||!newSrv.icon) return alert('Please fill in all fields.');
      const res = await API('/api/servers',{
        method:'POST', headers:{'Content-Type':'application/json'},
        body:JSON.stringify(newSrv)
      });
      if(!res.ok) return alert('Failed to add server');
      servers.push(newSrv); renderServers(); alert('Server added!');
    };

    // ZIP-upload handler
    async function uploadNewModel(){
      const name=document.getElementById('new-model-name').value.trim();
      const zipFile=document.getElementById('new-model-zip').files[0];
      if(!name) return alert('Enter a model name.');
      if(!zipFile) return alert('Select a ZIP file.');
      try{
        const zip=await JSZip.loadAsync(zipFile);
        const entries=Object.values(zip.files).filter(f=>!f.dir&&/\.(jpe?g|png|gif|mp4|webm)$/i.test(f.name));
        if(entries.length<20) return alert('ZIP must contain at least 20 files.');
        const urls=[];
        for(const file of entries){
          const base64=await file.async('base64');
          const ext=file.name.split('.').pop().toLowerCase();
          let mime='application/octet-stream';
          if(['jpg','jpeg'].includes(ext)) mime='image/jpeg';
          else if(ext==='png') mime='image/png';
          else if(ext==='gif') mime='image/gif';
          else if(ext==='mp4') mime='video/mp4';
          else if(ext==='webm') mime='video/webm';
          urls.push(`data:${mime};base64,${base64}`);
        }
        const model={ name, endpoints:[{name:'Uploaded Model',type:'gallery',items:urls}] };
        results.push(model);
        localStorage.setItem('n3xus_results',JSON.stringify(results));
        await API('/api/models',{
          method:'POST',headers:{'Content-Type':'application/json'},
          body:JSON.stringify(model)
        });
        alert('Model uploaded!'); renderModels(results); renderJPG5(results); showSection('models');
      }catch(e){ console.error(e); alert('Error processing ZIP.'); }
    }
    document.getElementById('new-model-zip').addEventListener('change', uploadNewModel);
    // Delete Model
    document.getElementById('delete-model-btn').onclick = async () => {
      const name = document.getElementById('delete-model-name').value.trim();
      if (!name) return alert('Enter a model name to delete.');
      const res = await API(`/api/models/${encodeURIComponent(name)}`, {
        method: 'DELETE'
      });
      if (res.status === 204) {
        // Update front-end state
        results = results.filter(m => m.name !== name);
        localStorage.setItem('n3xus_results', JSON.stringify(results));
        renderModels(results);
        renderJPG5(results);
        alert(`Model “${name}” deleted.`);
      } else if (res.status === 404) {
        alert(`Model “${name}” not found.`);
      } else {
        const text = await res.text();
        alert(`Failed to delete: ${text}`);
      }
    };
  </script>
</body>
</html>
